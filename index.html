<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calculadora The Crims</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #1a202c; /* Dark background */
            color: #e2e8f0; /* Light text */
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            padding: 20px;
            box-sizing: border-box;
        }
        .container {
            background-color: #2d3748; /* Darker blue-gray */
            padding: 32px;
            border-radius: 12px; /* Rounded corners */
            box-shadow: 0 10px 15px rgba(0, 0, 0, 0.2);
            max-width: 600px;
            width: 100%;
            text-align: center;
            display: flex;
            flex-direction: column;
            gap: 20px; /* Space between sections */
        }
        h1 {
            font-size: 2rem; /* Larger heading */
            font-weight: 700; /* font-bold */
            margin-bottom: 16px;
            color: #4299e1; /* Blue color for heading */
        }
        .tab-navigation {
            display: flex;
            justify-content: center;
            margin-bottom: 20px;
            border-bottom: 2px solid #4a5568;
        }
        .tab-button {
            background-color: #4a5568;
            color: #e2e8f0;
            padding: 12px 20px;
            border: none;
            border-radius: 8px 8px 0 0;
            cursor: pointer;
            font-size: 1.125rem;
            font-weight: 600;
            transition: background-color 0.3s ease;
            margin: 0 2px;
        }
        .tab-button:hover {
            background-color: #6a768a;
        }
        .tab-button.active {
            background-color: #4299e1;
            color: white;
            border-bottom: 2px solid #4299e1;
        }
        .tab-content {
            display: none; /* Hidden by default */
        }
        .tab-content.active {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        .section-title {
            font-size: 1.25rem; /* text-xl */
            font-weight: 600;
            color: #a0aec0; /* Lighter gray for section titles */
            margin-bottom: 12px;
            border-bottom: 1px solid #4a5568;
            padding-bottom: 8px;
        }
        .input-group {
            margin-bottom: 16px;
            text-align: left;
        }
        .input-group label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
        }
        .time-inputs, .points-inputs {
            display: flex;
            gap: 8px;
        }
        .time-inputs input[type="number"],
        .points-inputs input[type="number"] {
            flex: 1;
            padding: 10px;
            border-radius: 8px;
            border: 1px solid #4a5568;
            background-color: #4a5568;
            color: #e2e8f0;
            font-size: 1rem;
            text-align: center;
            -moz-appearance: textfield;
        }
        .time-inputs input[type="number"]::-webkit-outer-spin-button,
        .time-inputs input[type="number"]::-webkit-inner-spin-button,
        .points-inputs input[type="number"]::-webkit-outer-spin-button,
        .points-inputs input[type="number"]::-webkit-inner-spin-button {
            -webkit-appearance: none;
            margin: 0;
        }
        input[type="datetime-local"],
        select {
            width: 100%;
            padding: 10px;
            border-radius: 8px;
            border: 1px solid #4a5568;
            background-color: #4a5568;
            color: #e2e8f0;
            font-size: 1rem;
        }
        input[readonly] {
            background-color: #3d485b;
            cursor: default;
            opacity: 0.9;
        }
        .button-group {
            display: flex;
            gap: 16px;
            margin-top: 24px;
        }
        button {
            flex: 1;
            background-color: #4299e1;
            color: white;
            padding: 12px 24px;
            border-radius: 8px;
            font-size: 1.125rem;
            font-weight: 700;
            border: none;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.1s ease;
        }
        button:hover {
            background-color: #3182ce;
            transform: translateY(-2px);
        }
        button:active {
            transform: translateY(0);
        }
        #resetButton {
            background-color: #e53e3e; /* Red for reset */
        }
        #resetButton:hover {
            background-color: #c53030;
        }
        #result, #pointsResult {
            margin-top: 24px;
            font-size: 1.25rem;
            font-weight: 700;
            color: #68d391;
            min-height: 30px;
        }
        #localTimeResult {
            font-size: 1rem;
            font-weight: 500;
            color: #a0aec0;
            margin-top: 8px;
        }
        .error-message {
            color: #fc8181;
            margin-top: 10px;
            font-size: 0.875rem;
            font-weight: 500;
        }
        .attribute-result {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
            border-bottom: 1px dashed #4a5568;
        }
        .attribute-result:last-child {
            border-bottom: none;
        }
        .attribute-label {
            font-weight: 600;
            color: #cbd5e0;
        }
        .attribute-value {
            color: #68d391;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Calculadora The Crims</h1>

        <div class="tab-navigation">
            <button class="tab-button active" onclick="showTab('timeCalculatorTabContent')">Calculadora de Tempo</button>
            <button class="tab-button" onclick="showTab('pointsCalculatorTabContent')">Calculadora de Pontos</button>
        </div>

        <!-- Time Calculator Tab Content -->
        <div id="timeCalculatorTabContent" class="tab-content active">
            <div>
                <div class="section-title">Informações da Rodada</div>
                <div class="input-group">
                    <label for="roundStartDate">Data/Hora de Início da Rodada Atual (Vida Real):</label>
                    <input type="datetime-local" id="roundStartDate">
                </div>

                <div class="input-group">
                    <label for="currentRoundEndDate">Data/Hora de Fim da Rodada Atual (Vida Real):</label>
                    <input type="datetime-local" id="currentRoundEndDate" readonly>
                </div>
            </div>

            <div>
                <div class="section-title">Tempo Atual no Jogo</div>
                <div class="input-group">
                    <label>Calculado automaticamente:</label>
                    <div class="time-inputs">
                        <input type="number" id="currentDay" placeholder="Dia" readonly>
                        <input type="number" id="currentHour" placeholder="Hora" readonly>
                        <input type="number" id="currentMinute" placeholder="Minuto" readonly>
                    </div>
                </div>
            </div>

            <div>
                <div class="section-title">Tempo Desejado no Jogo</div>
                <div class="input-group">
                    <label for="targetDay">Insira o tempo futuro desejado:</label>
                    <div class="time-inputs">
                        <input type="number" id="targetDay" placeholder="Dia" min="1">
                        <input type="number" id="targetHour" placeholder="Hora" min="0" max="23">
                        <input type="number" id="targetMinute" placeholder="Minuto" min="0" max="59">
                    </div>
                </div>
            </div>

            <div class="button-group">
                <button onclick="calculateTime()">Calcular Tempo Real</button>
                <button id="resetTimeCalculatorButton" onclick="resetTimeCalculator()">Redefinir</button>
            </div>

            <div id="result"></div>
            <div id="localTimeResult"></div>
            <div id="errorMessage"></div>
        </div>

        <!-- Points Calculator Tab Content -->
        <div id="pointsCalculatorTabContent" class="tab-content">
            <div>
                <div class="section-title">Calculadora de Pontos de Atributo</div>
                <div class="input-group">
                    <label for="totalPoints">Total de Pontos para Distribuir:</label>
                    <input type="number" id="totalPoints" min="0" value="10000">
                </div>
                <div class="input-group">
                    <label for="playerClass">Sua Classe:</label>
                    <select id="playerClass">
                        <option value="assassino">Assassino de Aluguel</option>
                        <option value="cafetao">Cafetão</option>
                        <option value="corretor">Corretor</option>
                        <option value="empresario">Empresário</option>
                        <option value="ladrao">Ladrão</option>
                        <option value="traficante">Traficante</option>
                    </select>
                </div>
            </div>

            <div class="button-group">
                <button onclick="calculatePoints()">Calcular Distribuição</button>
                <button id="resetPointsCalculatorButton" onclick="resetPointsCalculator()">Redefinir</button>
            </div>

            <div id="pointsResult"></div>
            <div id="pointsErrorMessage" class="error-message"></div>
        </div>
    </div>

    <script>
        // --- Global Constants ---
        const REAL_HOURS_PER_GAME_DAY = 6;
        const GAME_HOURS_PER_REAL_HOUR = 24 / REAL_HOURS_PER_GAME_DAY;
        const GAME_MINUTES_PER_REAL_MINUTE = GAME_HOURS_PER_REAL_HOUR * 60 / 60;

        const DEFAULT_ROUND_START_DATE = new Date(2025, 6, 2, 12, 0); // Month is 0-indexed (July is 6)
        const ROUND_DURATION_GAME_DAYS = 52; // Game round lasts 52 days

        // --- Utility Functions ---
        function formatDateForInput(date) {
            const year = date.getFullYear();
            const month = String(date.getMonth() + 1).padStart(2, '0');
            const day = String(date.getDate()).padStart(2, '0');
            const hours = String(date.getHours()).padStart(2, '0');
            const minutes = String(date.getMinutes()).padStart(2, '0');
            return `${year}-${month}-${day}T${hours}:${minutes}`;
        }

        function clearMessages(elementIds) {
            elementIds.forEach(id => {
                const element = document.getElementById(id);
                if (element) element.textContent = '';
            });
        }

        // --- Tab Navigation Logic ---
        function showTab(tabId) {
            const tabContents = document.querySelectorAll('.tab-content');
            tabContents.forEach(content => {
                content.classList.remove('active');
            });

            const tabButtons = document.querySelectorAll('.tab-button');
            tabButtons.forEach(button => {
                button.classList.remove('active');
            });

            document.getElementById(tabId).classList.add('active');
            document.querySelector(`.tab-button[onclick*="${tabId}"]`).classList.add('active');

            // Recalculate current game time when switching to time calculator tab
            if (tabId === 'timeCalculatorTabContent') {
                calculateCurrentGameTime();
                calculateCurrentRoundEndDate(); // Also calculate end date
            }
            // Clear messages when switching tabs
            clearMessages(['errorMessage', 'result', 'localTimeResult', 'pointsErrorMessage', 'pointsResult']);
        }

        // --- Time Calculator Functions ---
        function calculateCurrentGameTime() {
            const roundStartDateInput = document.getElementById('roundStartDate').value;
            const errorDiv = document.getElementById('errorMessage');

            if (!roundStartDateInput) {
                document.getElementById('currentDay').value = '';
                document.getElementById('currentHour').value = '';
                document.getElementById('currentMinute').value = '';
                return false;
            }

            const roundStartDate = new Date(roundStartDateInput);
            const now = new Date();

            const diffMs = now.getTime() - roundStartDate.getTime();

            if (diffMs < 0) {
                document.getElementById('currentDay').value = 1;
                document.getElementById('currentHour').value = 0;
                document.getElementById('currentMinute').value = 0;
                return false;
            }

            const diffRealMinutes = diffMs / (1000 * 60);
            const diffGameMinutes = diffRealMinutes * GAME_MINUTES_PER_REAL_MINUTE;

            const gameDays = Math.floor(diffGameMinutes / (24 * 60));
            const remainingMinutesGame = diffGameMinutes % (24 * 60);
            const gameHours = Math.floor(remainingMinutesGame / 60);
            const gameMinutes = Math.floor(remainingMinutesGame % 60);

            const currentDayGame = gameDays + 1;
            const currentHourGame = gameHours;
            const currentMinuteGame = gameMinutes;

            document.getElementById('currentDay').value = currentDayGame;
            document.getElementById('currentHour').value = currentHourGame;
            document.getElementById('currentMinute').value = currentMinuteGame;

            return true;
        }

        function calculateCurrentRoundEndDate() {
            const roundStartDateInput = document.getElementById('roundStartDate').value;
            const currentRoundEndDateInput = document.getElementById('currentRoundEndDate');

            if (!roundStartDateInput) {
                currentRoundEndDateInput.value = '';
                return;
            }

            const roundStartDate = new Date(roundStartDateInput);
            // Calculate end date: Start Date + (52 game days * 6 real hours/game day)
            const endDateMs = roundStartDate.getTime() + (ROUND_DURATION_GAME_DAYS * REAL_HOURS_PER_GAME_DAY * 60 * 60 * 1000);
            const currentRoundEndDate = new Date(endDateMs);

            currentRoundEndDateInput.value = formatDateForInput(currentRoundEndDate);
        }

        function calculateTime() {
            clearMessages(['result', 'localTimeResult', 'errorMessage']);

            const isCurrentTimeCalculated = calculateCurrentGameTime();
            if (!isCurrentTimeCalculated) {
                document.getElementById('errorMessage').textContent = 'Por favor, insira uma Data/Hora de Início da Rodada válida e no passado.';
                return;
            }

            const currentDay = parseInt(document.getElementById('currentDay').value);
            const currentHour = parseInt(document.getElementById('currentHour').value);
            const currentMinute = parseInt(document.getElementById('currentMinute').value);

            const targetDay = parseInt(document.getElementById('targetDay').value);
            const targetHour = parseInt(document.getElementById('targetHour').value);
            const targetMinute = parseInt(document.getElementById('targetMinute').value);

            if (isNaN(targetDay) || isNaN(targetHour) || isNaN(targetMinute)) {
                document.getElementById('errorMessage').textContent = 'Por favor, preencha os campos de "Tempo Desejado" com números válidos.';
                return;
            }
            if (targetDay < 1) {
                document.getElementById('errorMessage').textContent = 'O Dia desejado deve ser no mínimo 1.';
                return;
            }
            if (targetHour < 0 || targetHour > 23) {
                document.getElementById('errorMessage').textContent = 'A Hora desejada deve estar entre 0 e 23.';
                return;
            }
            if (targetMinute < 0 || targetMinute > 59) {
                document.getElementById('errorMessage').textContent = 'O Minuto desejado deve estar entre 0 e 59.';
                return;
            }

            const currentTotalMinutesGame = (currentDay * 24 * 60) + (currentHour * 60) + currentMinute;
            const targetTotalMinutesGame = (targetDay * 24 * 60) + (targetHour * 60) + targetMinute;

            if (targetTotalMinutesGame < currentTotalMinutesGame) {
                document.getElementById('errorMessage').textContent = 'O tempo desejado deve ser no futuro em relação ao tempo atual do jogo.';
                return;
            }

            const differenceMinutesGame = targetTotalMinutesGame - currentTotalMinutesGame;
            const differenceRealSeconds = differenceMinutesGame * (60 / GAME_MINUTES_PER_REAL_MINUTE);

            const realHours = Math.floor(differenceRealSeconds / 3600);
            const remainingSecondsAfterHours = differenceRealSeconds % 3600;
            const realMinutes = Math.floor(remainingSecondsAfterHours / 60);
            const realSeconds = Math.floor(remainingSecondsAfterHours % 60);

            let resultText = 'Tempo real necessário: ';
            if (realHours > 0) {
                resultText += `${realHours} hora${realHours !== 1 ? 's' : ''}`;
            }
            if (realMinutes > 0) {
                if (realHours > 0) resultText += ', ';
                resultText += `${realMinutes} minuto${realMinutes !== 1 ? 's' : ''}`;
            }
            if (realSeconds > 0) {
                if (realHours > 0 || realMinutes > 0) resultText += ' e ';
                resultText += `${realSeconds} segundo${realSeconds !== 1 ? 's' : ''}`;
            }
            if (realHours === 0 && realMinutes === 0 && realSeconds === 0) {
                resultText = 'O tempo atual e o tempo desejado são os mesmos.';
            }

            document.getElementById('result').textContent = resultText;

            const now = new Date();
            const targetRealLifeTimeMs = now.getTime() + (differenceRealSeconds * 1000);
            const targetRealLifeDate = new Date(targetRealLifeTimeMs);

            document.getElementById('localTimeResult').textContent = `Hora local prevista: ${targetRealLifeDate.toLocaleString('pt-BR', { dateStyle: 'full', timeStyle: 'medium' })}`;
        }

        function resetTimeCalculator() {
            document.getElementById('roundStartDate').value = formatDateForInput(DEFAULT_ROUND_START_DATE);
            calculateCurrentRoundEndDate(); // Calculate end date on reset

            // Get current game time after reset and set it as target default
            calculateCurrentGameTime();
            document.getElementById('targetDay').value = document.getElementById('currentDay').value;
            document.getElementById('targetHour').value = document.getElementById('currentHour').value;
            document.getElementById('targetMinute').value = document.getElementById('currentMinute').value;

            clearMessages(['result', 'localTimeResult', 'errorMessage']);
        }

        // --- Points Calculator Functions ---
        // Percentagens otimizadas para cada classe com base nas suas vantagens e desvantagens no jogo.
        // A soma das percentagens para cada classe deve ser 1.0 (100%).

        const TRAFICANTE_PERCENTAGES = {
            Inteligência: 0.38,
            Tolerância: 0.28,
            Carisma: 0.28,
            Força: 0.06
        };

        const CAFETÃO_PERCENTAGES = {
            Carisma: 0.40,
            Inteligência: 0.25,
            Tolerância: 0.25,
            Força: 0.10
        };

        const EMPRESARIO_PERCENTAGES = { // Businessman
            Inteligência: 0.45,
            Carisma: 0.35,
            Tolerância: 0.15,
            Força: 0.05
        };

        const LADRAO_PERCENTAGES = { // Robber
            Inteligência: 0.40,
            Tolerância: 0.35,
            Força: 0.20,
            Carisma: 0.05
        };

        const CORRETOR_PERCENTAGES = { // Broker
            Inteligência: 0.45,
            Carisma: 0.35,
            Tolerância: 0.15,
            Força: 0.05
        };

        const ASSASSINO_PERCENTAGES = { // Hitman
            Força: 0.50,
            Tolerância: 0.30,
            Inteligência: 0.15,
            Carisma: 0.05
        };


        function calculatePoints() {
            clearMessages(['pointsResult', 'pointsErrorMessage']);

            const totalPoints = parseInt(document.getElementById('totalPoints').value);
            const playerClass = document.getElementById('playerClass').value;
            const pointsResultDiv = document.getElementById('pointsResult');
            const pointsErrorDiv = document.getElementById('pointsErrorMessage');

            if (isNaN(totalPoints) || totalPoints < 0) {
                pointsErrorDiv.textContent = 'Por favor, insira um total de pontos válido (número positivo).';
                return;
            }

            let percentages;
            switch (playerClass) {
                case 'traficante':
                    percentages = TRAFICANTE_PERCENTAGES;
                    break;
                case 'cafetao':
                    percentages = CAFETÃO_PERCENTAGES;
                    break;
                case 'empresario':
                    percentages = EMPRESARIO_PERCENTAGES;
                    break;
                case 'ladrao':
                    percentages = LADRAO_PERCENTAGES;
                    break;
                case 'corretor':
                    percentages = CORRETOR_PERCENTAGES;
                    break;
                case 'assassino':
                    percentages = ASSASSINO_PERCENTAGES;
                    break;
                default:
                    pointsErrorDiv.textContent = 'Classe de jogador inválida selecionada.';
                    return;
            }

            let resultHtml = `
                <p class="text-xl font-bold mb-4">Distribuição para ${document.getElementById('playerClass').options[document.getElementById('playerClass').selectedIndex].text} (${totalPoints} pontos):</p>
            `;

            for (const attribute in percentages) {
                const points = Math.round(totalPoints * percentages[attribute]);
                resultHtml += `
                    <div class="attribute-result">
                        <span class="attribute-label">${attribute}:</span>
                        <span class="attribute-value">${points} pontos (${(percentages[attribute] * 100).toFixed(0)}%)</span>
                    </div>
                `;
            }
            pointsResultDiv.innerHTML = resultHtml;
        }

        function resetPointsCalculator() {
            document.getElementById('totalPoints').value = 10000;
            document.getElementById('playerClass').value = 'assassino'; // Default to Assassino (first in alpha list)
            clearMessages(['pointsResult', 'pointsErrorMessage']);
        }

        // --- Initialization ---
        window.onload = function() {
            resetTimeCalculator(); // Initialize Time Calculator defaults and set target time to current
            resetPointsCalculator(); // Initialize Points Calculator defaults
            showTab('timeCalculatorTabContent'); // Show time calculator tab by default

            // Update current game time every second for a more "real-time" feel
            setInterval(calculateCurrentGameTime, 1000);
            // Update current round end date less frequently as it's static per round
            setInterval(calculateCurrentRoundEndDate, 60 * 1000); // Every minute
        };
    </script>
</body>
</html>
